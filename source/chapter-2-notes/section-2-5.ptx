<handout xml:id="handout-section-2-5-lu">
  <title>2.5 <m>LU</m> Factorization</title>

  <page xml:id="p-2-5-intro-objectives">
    <title>Overview</title>



    <objectives xml:id="obj-2-5-topics-goals">
      <title>Topics</title>
      <ul>
        <li>The <m>LU</m> factorization of a matrix.</li>
        <li>Using <m>LU</m> factorization to solve a system.</li>
        <li>Why the <m>LU</m> factorization works.</li>
      </ul>
    </objectives>
    <objectives>
      <title>Goals</title>
      <ul>
        <li>Compute an <m>LU</m> factorization of a matrix.</li>
        <li>Apply <m>LU</m> factorization to solve systems of equations.</li>
        <li>Determine whether a matrix has an <m>LU</m> factorization.</li>
      </ul>
    </objectives>

    <p workspace="0.1in"> We have learned several techniques for solving the equation <m>A\vec x = \vec b</m>. We <em>could</em> solve <m>A\vec x=\vec b</m> using <m>\vec x=A^{-1}\vec b</m>, but this requires computing the inverse of an <m>n\times n</m> matrix, which becomes difficult for large <m>n</m>. Gaussian elimination is better, but still inefficient for large systems.
    </p>
    <p workspace="0.1in">More efficient and numerically stable methods rely on matrix factorizations. A <term>matrix factorization</term> (or <term>matrix decomposition</term>) is a factorization of a matrix into a product of matrices. Such factorizations help solve <m>A\vec x=\vec b</m> and reveal matrix structure. Several matrix factorizations appear throughout this course. In this section, we factor a matrix into <em>lower</em> and <em>upper</em> triangular matrices.
    </p>

    <p>A rectangular matrix <m>A</m> is <term>upper triangular</term> if <m>a_{i,j}=0</m> whenever <m>i&gt;j</m>.
    </p>

    <me>
      \begin{bmatrix}
        1 \amp 5 \amp 0\\
        0 \amp 2 \amp 4
      \end{bmatrix},
      \quad
      \begin{bmatrix}
        1 \amp 0 \amp 0 \amp 1\\
        0 \amp 2 \amp 1 \amp 0\\
        0 \amp 0 \amp 1 \amp 0\\
        0 \amp 0 \amp 0 \amp 1
      \end{bmatrix},
      \quad
      \begin{bmatrix}
        2\\0\\0\\0
      \end{bmatrix}
    </me>

    <p>
        A rectangular matrix <m>A</m> is <term>lower triangular</term> if <m>a_{i,j}=0</m> whenever <m>i&lt;j</m>.
    </p>

    <me>
      \begin{bmatrix}
        1 \amp 0 \amp 0\\
        3 \amp 2 \amp 0
      \end{bmatrix},
      \quad
      \begin{bmatrix}
        3 \amp 0 \amp 0 \amp 0\\
        1 \amp 1 \amp 0 \amp 0\\
        0 \amp 0 \amp 1 \amp 0\\
        0 \amp 2 \amp 0 \amp 1
      \end{bmatrix},
      \quad
      \begin{bmatrix}
        1\\2\\1\\2
      \end{bmatrix}
    </me>

    <p workspace="0.2in">Can you have a matrix that is both upper and lower triangular?</p>
  </page>


  <page xml:id="p-2-5-lu-definition">
    <title>The <m>LU</m> Factorization</title>

    <theorem xml:id="thm-lu-factorization">
      <title><m>LU</m> Factorization</title>
      <statement>
        <p>
          If <m>A</m> is an <m>m\times n</m> matrix that can be row reduced to echelon form without row exchanges, then there exists matrices <m>L</m> and <m>U</m> such that <m>A=LU</m>, where
        </p>
        <ul>
          <li><m>L</m> is a lower triangular <m>m\times m</m> matrix with ones on the diagonal.</li>
          <li><m>U</m> is an echelon form of <m>A</m>.</li>
        </ul>
      </statement>
    </theorem>


    <example xml:id="ex-lu-form" workspace="true">
      <statement>
        <p>
          If <m>A</m> is a <m>3 \times 2</m> matrix, then its LU factorization has the form:
        </p>
        <me>
          A=LU=
          \begin{bmatrix}
            1 \amp 0 \amp 0\\
            \ast \amp 1 \amp 0\\
            \ast \amp \ast \amp 1
          \end{bmatrix}
          \begin{bmatrix}
            \ast \amp \ast\\
            0 \amp \ast\\
            0 \amp 0
          \end{bmatrix}
        </me>
      </statement>
    </example>

    <p>
      How do we find <m>L </m> and <m>U</m>? Suppose <m>A</m> can be row reduced to echelon form <m>U</m> without interchanging rows. Then
    </p>

    <me>
      E_p\cdots E_1A=U,
    </me>

    <p>
      where the <m>E_j</m> are elementary row-operation matrices. These matrices are lower triangular and invertible. For example, 
    </p>

    <me>
      \begin{bmatrix}
        1 \amp 0 \amp 0\\
        0 \amp 1 \amp 0\\
        2 \amp 0 \amp 1
      \end{bmatrix}^{-1}
      =
      \begin{bmatrix}
        1 \amp 0 \amp 0\\
        0 \amp 1 \amp 0\\
        -2 \amp 0 \amp 1
      \end{bmatrix}.
    </me>

    <p workspace="true">
      Therefore:

    <me>
      A = E_1^{-1}\cdots E_p^{-1}U = LU.
    </me>
    </p>
  </page>

  <page xml:id="p-2-5-algorithm-computing-lu">
    <title>Algorithm for Computing <m>LU</m></title>

    <p>To compute an LU factorization:

    <ol>
      <li>
        Reduce <m>A</m> to an echelon form <m>U</m> using only row replacement operations. So no row swapping or scaling.
      </li>
      <li>
        Place entries in <m>L</m> so that the same sequence of row operations reduce <m>L</m> to <m>I</m>.
      </li>
    </ol>

       Note, in MATH 1554, the only allowed row replacement operation can be written in the form <m>R_i - kR_j \rightarrow R_i</m>. The number <m>k</m> is what should go into the <m>i^\text{th}</m> row and <m>j^\text{th}</m> column of <m>L</m>, so <m>\ell_{i,j} = k</m>.
    </p>

    <example xml:id="ex-compute-lu" workspace="true">
      <statement>
        <p>Compute the LU factorization of:</p>
        <me>
          A=
          \begin{bmatrix}
            4 \amp -3 \amp -1 \amp 5\\
            -16 \amp 12 \amp 2 \amp -17\\
            8 \amp -6 \amp -12 \amp 22
          \end{bmatrix}.
        </me>
      </statement>
    </example>
  </page>

  <page>
    <example xml:id="ex-compute-lu2" workspace="true">
      <statement>
        <p>Compute the LU factorization of:</p>
        <me>
          A=
          \begin{bmatrix}
            3 \amp -1 \amp 4 \amp 5\\
            6 \amp 0 \amp 10 \amp 12\\
            3 \amp 3 \amp 8 \amp 10\\
            6 \amp 2 \amp 12 \amp 15\\
            3 \amp 3 \amp 8 \amp 9
          \end{bmatrix}.
        </me>
      </statement>
    </example>
  </page>


  <page xml:id="p-2-5-using-lu">
    <title>Using the <m>LU</m> Decomposition</title>

    <p>How do we use <m>LU</m> factorization to help us solve <m>A\vec x=\vec b</m>?</p>

    <p>If <m>A = LU</m>, then the equation <m>A \vec x = \vec b </m> can be written <m>LU \vec x = \vec b </m>, or equivalently, <m>L (U\vec x) = \vec b </m>. Setting <m>\vec y = U\vec x </m>, we do the following:
    </p>

    <ol>
      <li>Forward substitution to solve for <m>\vec y</m> in <m>L\vec y=\vec b</m>.</li>
      <li>Backward substitution to solve for <m>\vec x</m> in <m>U\vec x=\vec y</m>.</li>
    </ol>

    <example xml:id="ex-solve-with-lu" workspace="true">
      <statement>
        <p>Solve the linear system with:</p>
        <me>
          A=LU=
          \begin{bmatrix}
            1 \amp 0 \amp 0 \amp 0\\
            1 \amp 1 \amp 0 \amp 0\\
            0 \amp 2 \amp 1 \amp 0\\
            0 \amp 0 \amp 1 \amp 1
          \end{bmatrix}
          \begin{bmatrix}
            1 \amp 0 \amp 0\\
            0 \amp 2 \amp 1\\
            0 \amp 0 \amp 2\\
            0 \amp 0 \amp 0
          \end{bmatrix},
          \qquad
          \vec b=
          \begin{bmatrix}
            2\\3\\2\\0
          \end{bmatrix}.
        </me>
      </statement>
    </example>
  </page>

</handout>